<!DOCTYPE html>
<html lang="en-us">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="author" content="">
<title>Fitting along slices -- BornAgain</title>


<link href="https://scgmlz.github.io/BornAgain-website//css/bootstrap.min.css" rel="stylesheet">

<link href="https://scgmlz.github.io/BornAgain-website//css/theme.css" rel="stylesheet">

<link href="https://scgmlz.github.io/BornAgain-website//css/mathjax-style.css" rel="stylesheet">

<link href="https://scgmlz.github.io/BornAgain-website//css/vs.css" rel="stylesheet">

<link href="https://scgmlz.github.io/BornAgain-website//css/baguetteBox.min.css" rel="stylesheet">
<link href="https://scgmlz.github.io/BornAgain-website//css/gallery-grid.css" rel="stylesheet">

<link href="https://scgmlz.github.io/BornAgain-website/assets/css/bornagain.css" rel="stylesheet">

<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
<link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
<link href="https://fonts.googleapis.com/css?family=Libre+Baskerville" rel='stylesheet'  type='text/css'> 
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
    var TEX = MathJax.InputJax.TeX;
    var PREFILTER = TEX.prefilterMath;
    TEX.Augment({
      prefilterMath: function (math,displaymode,script) {
        if (!displaymode) {math = "\\small{"+math+"}"}
        return PREFILTER.call(TEX,math,displaymode,script);
      }
    });
  });
  </script>

</head>


  <body>
    <header class="hero overlay"><div class="container">
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark bg-primary">
    <a class="navbar-brand" href="https://scgmlz.github.io/BornAgain-website/">
        <img src="https://scgmlz.github.io/BornAgain-website/assets/img/bornagain-logo.png" class="d-inline-block align-top" alt="">
        BornAgain
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
      <ul class="navbar-nav ml-auto mt-2 mt-lg-0">
        
        
          <li class="nav-item "> <a class="nav-link" href="https://scgmlz.github.io/BornAgain-website/">Home</a></li>
        
          <li class="nav-item "> <a class="nav-link" href="https://scgmlz.github.io/BornAgain-website/gallery/">Gallery</a></li>
        
          <li class="nav-item "> <a class="nav-link" href="https://scgmlz.github.io/BornAgain-website/download/">Download</a></li>
        
          <li class="nav-item "> <a class="nav-link" href="https://scgmlz.github.io/BornAgain-website/post/">News</a></li>
        
          <li class="nav-item active"> <a class="nav-link" href="https://scgmlz.github.io/BornAgain-website/documentation/">Documentation</a></li>
        
          <li class="nav-item "> <a class="nav-link" href="https://scgmlz.github.io/BornAgain-website/contact/">Contact</a></li>
        
          <li class="nav-item "> <a class="nav-link" href="https://scgmlz.github.io/BornAgain-website/about/">About</a></li>
          
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/scgmlz/BornAgain" target="_blank" rel="noopener" aria-label="GitHub">
              <span class="fa fa-github fa-2x"></span>
            </a>
          </li>        
        
      </ul>
    </div>
  </nav>
</div>
  
      <div class="container">
        <div class="row">
          <div class="col-lg-12"> <br></div>
        </div>
      </div>
    </header>

    
  <div class="breadcrumb">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">









 <a href='https://scgmlz.github.io/BornAgain-website/'>Home</a> > <a href='https://scgmlz.github.io/BornAgain-website/documentation/'>Documentation</a> > <a href='https://scgmlz.github.io/BornAgain-website/documentation/sample-models/'>Sample model reference</a> > <a href='https://scgmlz.github.io/BornAgain-website/documentation/sample-models/fitting/'>Fitting</a> > Fitting along slices

 

 

 

 

   
        </div>
      </div>
    </div>
</div>





    





<div class="container">
  <div class="row">
    <div class="col-md-8">
      
      
  
  

<h3 id="fitting-along-slices">Fitting along slices</h3>

<p>Here we demonstrate how to fit along slices. The idea is that the user defines positions of vertical and horizontal lines crossing the detector plane in regions of most interest (Yoneda wings, Bragg peaks, etc.) and then finds sample parameters which fits those regions best.</p>

<p>Such approach uses much less CPU while still giving a chance to find optimal sample parameters. In general, however, it is arguable, whether fitting along slices makes more sense than fitting using the whole detector image. Without going into this discussion we just provide such a possibility.</p>

<p>Technically, the idea is to mask the whole detector except thin lines, one vertical and one horizontal, representing slices. This will make the simulation and the fitting procedure to calculate only along these indicated slices.</p>

<ul>
<li>In the given scrip (see the <a href="#python-script">Python script</a>) we simulate cylinders on top of a substrate without interference. The fitting procedure looks for the cylinder&rsquo;s height and radius.</li>
<li>Lines 180, 181, 182 demonstrate the code you need for masking the whole detector and then unmasking the two desired slices: vertical line at $\phi=0.0^{\circ}$, and horizontal line at $\alpha=0.2^{\circ}$.</li>
<li>The majority of the code is located in custom <code>DrawObserver</code> class (defined in line 70, and invoked at lines 188, 189), which plots the fit progress along slices every 5th iteration.</li>
</ul>



<div class="galleryscg ">
    <div class="row justify-content-center align-items-center">
      
<figure >
 	  <a href="FitAlongSlices.png">
 	  	<img src="FitAlongSlices.png" width="600px">
 	  </a>
      <figcaption>
      	<p>Intensity image</p>
      </figcaption>
	</figure>


  </div>
</div>




<h4 id="python-script">Python script:</h4>


  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="lnt">  1</span><span class="lnt">  2</span><span class="lnt">  3</span><span class="lnt">  4</span><span class="lnt">  5</span><span class="lnt">  6</span><span class="lnt">  7</span><span class="lnt">  8</span><span class="lnt">  9</span><span class="lnt"> 10</span><span class="lnt"> 11</span><span class="lnt"> 12</span><span class="lnt"> 13</span><span class="lnt"> 14</span><span class="lnt"> 15</span><span class="lnt"> 16</span><span class="lnt"> 17</span><span class="lnt"> 18</span><span class="lnt"> 19</span><span class="lnt"> 20</span><span class="lnt"> 21</span><span class="lnt"> 22</span><span class="lnt"> 23</span><span class="lnt"> 24</span><span class="lnt"> 25</span><span class="lnt"> 26</span><span class="lnt"> 27</span><span class="lnt"> 28</span><span class="lnt"> 29</span><span class="lnt"> 30</span><span class="lnt"> 31</span><span class="lnt"> 32</span><span class="lnt"> 33</span><span class="lnt"> 34</span><span class="lnt"> 35</span><span class="lnt"> 36</span><span class="lnt"> 37</span><span class="lnt"> 38</span><span class="lnt"> 39</span><span class="lnt"> 40</span><span class="lnt"> 41</span><span class="lnt"> 42</span><span class="lnt"> 43</span><span class="lnt"> 44</span><span class="lnt"> 45</span><span class="lnt"> 46</span><span class="lnt"> 47</span><span class="lnt"> 48</span><span class="lnt"> 49</span><span class="lnt"> 50</span><span class="lnt"> 51</span><span class="lnt"> 52</span><span class="lnt"> 53</span><span class="lnt"> 54</span><span class="lnt"> 55</span><span class="lnt"> 56</span><span class="lnt"> 57</span><span class="lnt"> 58</span><span class="lnt"> 59</span><span class="lnt"> 60</span><span class="lnt"> 61</span><span class="lnt"> 62</span><span class="lnt"> 63</span><span class="lnt"> 64</span><span class="lnt"> 65</span><span class="lnt"> 66</span><span class="lnt"> 67</span><span class="lnt"> 68</span><span class="lnt"> 69</span><span class="lnt"> 70</span><span class="lnt"> 71</span><span class="lnt"> 72</span><span class="lnt"> 73</span><span class="lnt"> 74</span><span class="lnt"> 75</span><span class="lnt"> 76</span><span class="lnt"> 77</span><span class="lnt"> 78</span><span class="lnt"> 79</span><span class="lnt"> 80</span><span class="lnt"> 81</span><span class="lnt"> 82</span><span class="lnt"> 83</span><span class="lnt"> 84</span><span class="lnt"> 85</span><span class="lnt"> 86</span><span class="lnt"> 87</span><span class="lnt"> 88</span><span class="lnt"> 89</span><span class="lnt"> 90</span><span class="lnt"> 91</span><span class="lnt"> 92</span><span class="lnt"> 93</span><span class="lnt"> 94</span><span class="lnt"> 95</span><span class="lnt"> 96</span><span class="lnt"> 97</span><span class="lnt"> 98</span><span class="lnt"> 99</span><span class="lnt">100</span><span class="lnt">101</span><span class="lnt">102</span><span class="lnt">103</span><span class="lnt">104</span><span class="lnt">105</span><span class="lnt">106</span><span class="lnt">107</span><span class="lnt">108</span><span class="lnt">109</span><span class="lnt">110</span><span class="lnt">111</span><span class="lnt">112</span><span class="lnt">113</span><span class="lnt">114</span><span class="lnt">115</span><span class="lnt">116</span><span class="lnt">117</span><span class="lnt">118</span><span class="lnt">119</span><span class="lnt">120</span><span class="lnt">121</span><span class="lnt">122</span><span class="lnt">123</span><span class="lnt">124</span><span class="lnt">125</span><span class="lnt">126</span><span class="lnt">127</span><span class="lnt">128</span><span class="lnt">129</span><span class="lnt">130</span><span class="lnt">131</span><span class="lnt">132</span><span class="lnt">133</span><span class="lnt">134</span><span class="lnt">135</span><span class="lnt">136</span><span class="lnt">137</span><span class="lnt">138</span><span class="lnt">139</span><span class="lnt">140</span><span class="lnt">141</span><span class="lnt">142</span><span class="lnt">143</span><span class="lnt">144</span><span class="lnt">145</span><span class="lnt">146</span><span class="lnt">147</span><span class="lnt">148</span><span class="lnt">149</span><span class="lnt">150</span><span class="lnt">151</span><span class="lnt">152</span><span class="lnt">153</span><span class="lnt">154</span><span class="lnt">155</span><span class="lnt">156</span><span class="lnt">157</span><span class="lnt">158</span><span class="lnt">159</span><span class="lnt">160</span><span class="lnt">161</span><span class="lnt">162</span><span class="lnt">163</span><span class="lnt">164</span><span class="lnt">165</span><span class="lnt">166</span><span class="lnt">167</span><span class="lnt">168</span><span class="lnt">169</span><span class="lnt">170</span><span class="lnt">171</span><span class="lnt">172</span><span class="lnt">173</span><span class="lnt">174</span><span class="lnt">175</span><span class="lnt">176</span><span class="lnt">177</span><span class="lnt">178</span><span class="lnt">179</span><span class="lnt">180</span><span class="lnt">181</span><span class="lnt">182</span><span class="lnt">183</span><span class="lnt">184</span><span class="lnt">185</span><span class="lnt">186</span><span class="lnt">187</span><span class="lnt">188</span><span class="lnt">189</span><span class="lnt">190</span><span class="lnt">191</span><span class="lnt">192</span><span class="lnt">193</span><span class="lnt">194</span><span class="lnt">195</span><span class="lnt">196</span><span class="lnt">197</span><span class="lnt">198</span><span class="lnt">199</span><span class="lnt">200</span><span class="lnt">201</span><span class="lnt">202</span><span class="lnt">203</span><span class="lnt">204</span><span class="lnt">205</span><span class="lnt">206</span><span class="lnt">207</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="sa"></span><span class="s2">&#34;&#34;&#34;
</span><span class="s2">Fitting example: fit along slices
</span><span class="s2">&#34;&#34;&#34;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">bornagain</span> <span class="kn">as</span> <span class="nn">ba</span>
<span class="kn">from</span> <span class="nn">bornagain</span> <span class="kn">import</span> <span class="n">deg</span><span class="p">,</span> <span class="n">angstrom</span><span class="p">,</span> <span class="n">nm</span>

<span class="n">phi_slice_value</span> <span class="o">=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">deg</span>  <span class="c1"># position of vertical slice</span>
<span class="n">alpha_slice_value</span> <span class="o">=</span> <span class="mf">0.2</span><span class="o">*</span><span class="n">deg</span>  <span class="c1"># position of horizontal slice</span>


<span class="k">def</span> <span class="nf">get_sample</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">5.0</span><span class="o">*</span><span class="n">nm</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">10.0</span><span class="o">*</span><span class="n">nm</span><span class="p">):</span>
    <span class="sa"></span><span class="s2">&#34;&#34;&#34;
</span><span class="s2">    Returns a sample with uncorrelated cylinders on a substrate.
</span><span class="s2">    &#34;&#34;&#34;</span>
    <span class="n">m_air</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">HomogeneousMaterial</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;Air&#34;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">m_substrate</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">HomogeneousMaterial</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;Substrate&#34;</span><span class="p">,</span> <span class="mf">6e-6</span><span class="p">,</span> <span class="mf">2e-8</span><span class="p">)</span>
    <span class="n">m_particle</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">HomogeneousMaterial</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;Particle&#34;</span><span class="p">,</span> <span class="mf">6e-4</span><span class="p">,</span> <span class="mf">2e-8</span><span class="p">)</span>

    <span class="n">cylinder_ff</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">FormFactorCylinder</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
    <span class="n">cylinder</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">Particle</span><span class="p">(</span><span class="n">m_particle</span><span class="p">,</span> <span class="n">cylinder_ff</span><span class="p">)</span>

    <span class="n">particle_layout</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">ParticleLayout</span><span class="p">()</span>
    <span class="n">particle_layout</span><span class="o">.</span><span class="n">addParticle</span><span class="p">(</span><span class="n">cylinder</span><span class="p">)</span>

    <span class="n">air_layer</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">Layer</span><span class="p">(</span><span class="n">m_air</span><span class="p">)</span>
    <span class="n">air_layer</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">particle_layout</span><span class="p">)</span>

    <span class="n">substrate_layer</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">Layer</span><span class="p">(</span><span class="n">m_substrate</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">multi_layer</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">MultiLayer</span><span class="p">()</span>
    <span class="n">multi_layer</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">air_layer</span><span class="p">)</span>
    <span class="n">multi_layer</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">substrate_layer</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">multi_layer</span>


<span class="k">def</span> <span class="nf">get_simulation</span><span class="p">():</span>
    <span class="sa"></span><span class="s2">&#34;&#34;&#34;
</span><span class="s2">    Create and return GISAXS simulation with beam and detector defined
</span><span class="s2">    &#34;&#34;&#34;</span>
    <span class="n">simulation</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">GISASSimulation</span><span class="p">()</span>
    <span class="n">simulation</span><span class="o">.</span><span class="n">setDetectorParameters</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="o">*</span><span class="n">deg</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">deg</span><span class="p">,</span>
                                     <span class="mi">100</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">deg</span><span class="p">,</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">deg</span><span class="p">)</span>
    <span class="n">simulation</span><span class="o">.</span><span class="n">setBeamParameters</span><span class="p">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">angstrom</span><span class="p">,</span> <span class="mf">0.2</span><span class="o">*</span><span class="n">deg</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">deg</span><span class="p">)</span>
    <span class="n">simulation</span><span class="o">.</span><span class="n">setBeamIntensity</span><span class="p">(</span><span class="mf">1e+08</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">simulation</span>


<span class="k">def</span> <span class="nf">create_real_data</span><span class="p">():</span>
    <span class="sa"></span><span class="s2">&#34;&#34;&#34;
</span><span class="s2">    Generating &#34;real&#34; data by adding noise to the simulated data.
</span><span class="s2">    &#34;&#34;&#34;</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">get_sample</span><span class="p">(</span><span class="mf">5.0</span><span class="o">*</span><span class="n">nm</span><span class="p">,</span> <span class="mf">10.0</span><span class="o">*</span><span class="n">nm</span><span class="p">)</span>
    <span class="n">simulation</span> <span class="o">=</span> <span class="n">get_simulation</span><span class="p">()</span>
    <span class="n">simulation</span><span class="o">.</span><span class="n">setSample</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">simulation</span><span class="o">.</span><span class="n">runSimulation</span><span class="p">()</span>

    <span class="c1"># retrieving simulated data in the form of numpy array</span>
    <span class="n">real_data</span> <span class="o">=</span> <span class="n">simulation</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">array</span><span class="p">()</span>

    <span class="c1"># spoiling simulated data with the noise to produce &#34;real&#34; data</span>
    <span class="n">noise_factor</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">noisy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">real_data</span><span class="p">,</span> <span class="n">noise_factor</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">real_data</span><span class="p">))</span>
    <span class="n">noisy</span><span class="p">[</span><span class="n">noisy</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="k">return</span> <span class="n">noisy</span>


<span class="k">class</span> <span class="nc">DrawObserver</span><span class="p">(</span><span class="n">ba</span><span class="o">.</span><span class="n">IFitObserver</span><span class="p">):</span>
    <span class="sa"></span><span class="s2">&#34;&#34;&#34;
</span><span class="s2">    Draws fit progress every nth iteration. Here we plot slices along real
</span><span class="s2">    and simulated images to see fit progress.
</span><span class="s2">    &#34;&#34;&#34;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw_every_nth</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">ba</span><span class="o">.</span><span class="n">IFitObserver</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw_every_nth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">10.25</span><span class="p">,</span> <span class="mf">7.69</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">plot_real_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">nplot</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nplot</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
            <span class="n">data</span><span class="o">.</span><span class="n">getArray</span><span class="p">(),</span>
            <span class="n">norm</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">getMaximum</span><span class="p">()),</span>
            <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">getXmin</span><span class="p">()</span><span class="o">/</span><span class="n">deg</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">getXmax</span><span class="p">()</span><span class="o">/</span><span class="n">deg</span><span class="p">,</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">getYmin</span><span class="p">()</span><span class="o">/</span><span class="n">deg</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">getYmax</span><span class="p">()</span><span class="o">/</span><span class="n">deg</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">Real</span><span class="se">\&#34;</span><span class="s2"> data&#34;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\phi_f$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\alpha_f$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="c1"># line representing vertical slice</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">phi_slice_value</span> <span class="o">/</span> <span class="n">deg</span><span class="p">,</span> <span class="n">phi_slice_value</span> <span class="o">/</span> <span class="n">deg</span><span class="p">],</span>
                 <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">getYmin</span><span class="p">()</span> <span class="o">/</span> <span class="n">deg</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">getYmax</span><span class="p">()</span> <span class="o">/</span> <span class="n">deg</span><span class="p">],</span>
                 <span class="n">color</span><span class="o">=</span><span class="sa"></span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sa"></span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># line representing horizontal slice</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">data</span><span class="o">.</span><span class="n">getXmin</span><span class="p">()</span> <span class="o">/</span> <span class="n">deg</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">getXmax</span><span class="p">()</span> <span class="o">/</span> <span class="n">deg</span><span class="p">],</span>
                 <span class="p">[</span><span class="n">alpha_slice_value</span> <span class="o">/</span> <span class="n">deg</span><span class="p">,</span> <span class="n">alpha_slice_value</span> <span class="o">/</span> <span class="n">deg</span><span class="p">],</span>
                 <span class="n">color</span><span class="o">=</span><span class="sa"></span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sa"></span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_slices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slices</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">nplot</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nplot</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="nb">slice</span> <span class="ow">in</span> <span class="n">slices</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="nb">slice</span><span class="o">.</span><span class="n">getBinCenters</span><span class="p">()</span><span class="o">/</span><span class="n">deg</span><span class="p">,</span>
                         <span class="nb">slice</span><span class="o">.</span><span class="n">getBinValues</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="nb">slice</span><span class="o">.</span><span class="n">getXmin</span><span class="p">()</span><span class="o">/</span><span class="n">deg</span><span class="p">,</span> <span class="nb">slice</span><span class="o">.</span><span class="n">getXmax</span><span class="p">()</span><span class="o">/</span><span class="n">deg</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="nb">slice</span><span class="o">.</span><span class="n">getMaximum</span><span class="p">()</span><span class="o">*</span><span class="mf">10.0</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="sa"></span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">display_fit_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fit_suite</span><span class="p">,</span> <span class="n">nplot</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nplot</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa"></span><span class="s1">&#39;Parameters&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="sa"></span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="sa"></span><span class="s2">&#34;Iteration  &#34;</span> <span class="o">+</span> <span class="sa"></span><span class="s1">&#39;{:d}     {:s}&#39;</span><span class="o">.</span>
                 <span class="n">format</span><span class="p">(</span><span class="n">fit_suite</span><span class="o">.</span><span class="n">numberOfIterations</span><span class="p">(),</span>
                        <span class="n">fit_suite</span><span class="o">.</span><span class="n">minimizer</span><span class="p">()</span><span class="o">.</span><span class="n">minimizerName</span><span class="p">()))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="sa"></span><span class="s2">&#34;Chi2       &#34;</span> <span class="o">+</span> <span class="sa"></span><span class="s1">&#39;{:8.4f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fit_suite</span><span class="o">.</span><span class="n">getChi2</span><span class="p">()))</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">fitPar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fit_suite</span><span class="o">.</span><span class="n">fitParameters</span><span class="p">()):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.55</span> <span class="o">-</span> <span class="n">index</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span>
                     <span class="sa"></span><span class="s1">&#39;{:30.30s}: {:6.3f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fitPar</span><span class="o">.</span><span class="n">name</span><span class="p">(),</span> <span class="n">fitPar</span><span class="o">.</span><span class="n">value</span><span class="p">()))</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fit_suite</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="n">real_data</span> <span class="o">=</span> <span class="n">fit_suite</span><span class="o">.</span><span class="n">getRealData</span><span class="p">()</span>
        <span class="n">simul_data</span> <span class="o">=</span> <span class="n">fit_suite</span><span class="o">.</span><span class="n">getSimulationData</span><span class="p">()</span>

        <span class="c1"># These lines add to make cast explicit, see Bug #1367</span>
        <span class="n">real_data</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">Histogram2D</span><span class="o">.</span><span class="n">dynamicCast</span><span class="p">(</span><span class="n">real_data</span><span class="p">)</span>
        <span class="n">simul_data</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">Histogram2D</span><span class="o">.</span><span class="n">dynamicCast</span><span class="p">(</span><span class="n">simul_data</span><span class="p">)</span>

        <span class="c1"># plot real data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_real_data</span><span class="p">(</span><span class="n">real_data</span><span class="p">,</span> <span class="n">nplot</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># horizontal slices</span>
        <span class="n">slices</span> <span class="o">=</span><span class="p">[</span>
            <span class="p">(</span><span class="sa"></span><span class="s2">&#34;real&#34;</span><span class="p">,</span> <span class="n">real_data</span><span class="o">.</span><span class="n">projectionX</span><span class="p">(</span><span class="n">alpha_slice_value</span><span class="p">)),</span>
            <span class="p">(</span><span class="sa"></span><span class="s2">&#34;simul&#34;</span><span class="p">,</span> <span class="n">simul_data</span><span class="o">.</span><span class="n">projectionX</span><span class="p">(</span><span class="n">alpha_slice_value</span><span class="p">))</span>
            <span class="p">]</span>
        <span class="n">title</span> <span class="o">=</span> <span class="p">(</span> <span class="sa"></span><span class="s2">&#34;Horizontal slice at alpha =&#34;</span> <span class="o">+</span>
                  <span class="sa"></span><span class="s1">&#39;{:3.1f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha_slice_value</span><span class="o">/</span><span class="n">deg</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_slices</span><span class="p">(</span><span class="n">slices</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">nplot</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># vertical slices</span>
        <span class="n">slices</span> <span class="o">=</span><span class="p">[</span>
            <span class="p">(</span><span class="sa"></span><span class="s2">&#34;real&#34;</span><span class="p">,</span> <span class="n">real_data</span><span class="o">.</span><span class="n">projectionY</span><span class="p">(</span><span class="n">phi_slice_value</span><span class="p">)),</span>
            <span class="p">(</span><span class="sa"></span><span class="s2">&#34;simul&#34;</span><span class="p">,</span> <span class="n">simul_data</span><span class="o">.</span><span class="n">projectionY</span><span class="p">(</span><span class="n">phi_slice_value</span><span class="p">))</span>
            <span class="p">]</span>
        <span class="n">title</span> <span class="o">=</span> <span class="sa"></span><span class="s2">&#34;Vertical slice at phi =&#34;</span> <span class="o">+</span> <span class="sa"></span><span class="s1">&#39;{:3.1f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">phi_slice_value</span><span class="o">/</span><span class="n">deg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_slices</span><span class="p">(</span><span class="n">slices</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">nplot</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

        <span class="c1"># display fit parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">display_fit_parameters</span><span class="p">(</span><span class="n">fit_suite</span><span class="p">,</span> <span class="n">nplot</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">fit_suite</span><span class="o">.</span><span class="n">isLastIteration</span><span class="p">():</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">run_fitting</span><span class="p">():</span>
    <span class="sa"></span><span class="s2">&#34;&#34;&#34;
</span><span class="s2">    main function to run fitting
</span><span class="s2">    &#34;&#34;&#34;</span>

    <span class="n">real_data</span> <span class="o">=</span> <span class="n">create_real_data</span><span class="p">()</span>

    <span class="n">sample</span> <span class="o">=</span> <span class="n">get_sample</span><span class="p">()</span>
    <span class="n">simulation</span> <span class="o">=</span> <span class="n">get_simulation</span><span class="p">()</span>
    <span class="n">simulation</span><span class="o">.</span><span class="n">setSample</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>

    <span class="c1"># At this point we mask all the detector and then unmask two areas</span>
    <span class="c1"># corresponding to the vertical and horizontal lines. This will make</span>
    <span class="c1"># simulation/fitting to be performed along slices only.</span>
    <span class="n">simulation</span><span class="o">.</span><span class="n">maskAll</span><span class="p">()</span>
    <span class="n">simulation</span><span class="o">.</span><span class="n">addMask</span><span class="p">(</span><span class="n">ba</span><span class="o">.</span><span class="n">HorizontalLine</span><span class="p">(</span><span class="n">alpha_slice_value</span><span class="p">),</span> <span class="bp">False</span><span class="p">)</span>
    <span class="n">simulation</span><span class="o">.</span><span class="n">addMask</span><span class="p">(</span><span class="n">ba</span><span class="o">.</span><span class="n">VerticalLine</span><span class="p">(</span><span class="n">phi_slice_value</span><span class="p">),</span> <span class="bp">False</span><span class="p">)</span>

    <span class="n">fit_suite</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">FitSuite</span><span class="p">()</span>
    <span class="n">fit_suite</span><span class="o">.</span><span class="n">addSimulationAndRealData</span><span class="p">(</span><span class="n">simulation</span><span class="p">,</span> <span class="n">real_data</span><span class="p">)</span>
    <span class="n">fit_suite</span><span class="o">.</span><span class="n">initPrint</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

    <span class="n">draw_observer</span> <span class="o">=</span> <span class="n">DrawObserver</span><span class="p">(</span><span class="n">draw_every_nth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">fit_suite</span><span class="o">.</span><span class="n">attachObserver</span><span class="p">(</span><span class="n">draw_observer</span><span class="p">)</span>

    <span class="c1"># setting fitting parameters with starting values</span>
    <span class="n">fit_suite</span><span class="o">.</span><span class="n">addFitParameter</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;*/Cylinder/Radius&#34;</span><span class="p">,</span> <span class="mf">6.</span><span class="o">*</span><span class="n">nm</span><span class="p">)</span><span class="o">.</span><span class="n">setLimited</span><span class="p">(</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">)</span>
    <span class="n">fit_suite</span><span class="o">.</span><span class="n">addFitParameter</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;*/Cylinder/Height&#34;</span><span class="p">,</span> <span class="mf">9.</span><span class="o">*</span><span class="n">nm</span><span class="p">)</span><span class="o">.</span><span class="n">setLimited</span><span class="p">(</span><span class="mf">8.</span><span class="p">,</span> <span class="mf">12.</span><span class="p">)</span>

    <span class="c1"># running fit</span>
    <span class="n">fit_suite</span><span class="o">.</span><span class="n">runFit</span><span class="p">()</span>

    <span class="k">print</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;Fitting completed.&#34;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa"></span><span class="s2">&#34;chi2:&#34;</span><span class="p">,</span> <span class="n">fit_suite</span><span class="o">.</span><span class="n">getChi2</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">fitPar</span> <span class="ow">in</span> <span class="n">fit_suite</span><span class="o">.</span><span class="n">fitParameters</span><span class="p">():</span>
        <span class="k">print</span><span class="p">(</span><span class="n">fitPar</span><span class="o">.</span><span class="n">name</span><span class="p">(),</span> <span class="n">fitPar</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span> <span class="n">fitPar</span><span class="o">.</span><span class="n">error</span><span class="p">())</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="sa"></span><span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">run_fitting</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div>

  
  
  

  
  

<a class="linktofile" href="https://scgmlz.github.io/BornAgain-website/files/python/fitting/ex07_FitAlongSlices/FitAlongSlices.py"/>
    FitAlongSlices.py
</a>





      <div class="container next-prev">
<nav>
  <ul class="pagination pagination-sm justify-content-end"><li class="page-item ">
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/fitting/fit-with-masks/" class="page-link"><i class="fa fa-chevron-left fa-1g "></i>
      </a>
    </li>  

    <li class="page-item ">
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/fitting/simultaneous-fit-of-two-datasets/" class="page-link"><i class="fa fa-chevron-right fa-1g "></i>
      </a>
    </li></ul>
</nav>
</div>

    </div>
    <div class="col-md-4">
    <ul class="doctree">
    <li class="dd-item parent">
          <i class="fa liOpened li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/"><span>Documentation</span></a>
        <ul>
    <li class="dd-item"><i class="fa liClosed li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/introduction/"><span>Introduction</span></a>
        <ul>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/introduction/architecture/"><span>Architectural overview</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/introduction/functionality/"><span>Functionality overview</span> </a>
    </li>
        </ul>
    </li>
    <li class="dd-item"><i class="fa liClosed li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/getting-started/"><span>Getting started</span></a>
        <ul>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/getting-started/quick-install/"><span>Quick installation instructions</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/getting-started/quick-start/"><span>Quick Start</span> </a>
    </li>
    <li class="dd-item"><i class="fa liClosed li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/getting-started/installation/"><span>Detailed installation instructions</span></a>
        <ul>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/getting-started/installation/windows/"><span>Installation on Windows</span> </a>
    </li>
    <li class="dd-item"><i class="fa liClosed li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/getting-started/installation/macos/"><span>Installation on MacOS</span></a>
        <ul>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/getting-started/installation/macos/advanced-tips/"><span>Advanced tips</span> </a>
    </li>
        </ul>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/getting-started/installation/unix-short/"><span>Installation on Unix (short version)</span> </a>
    </li>
    <li class="dd-item"><i class="fa liClosed li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/getting-started/installation/unix-detailed/"><span>Installation on Unix (detailed version)</span></a>
        <ul>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/getting-started/installation/unix-detailed/get-source/"><span>Get the source</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/getting-started/installation/unix-detailed/third-party/"><span>Install the third party software</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/getting-started/installation/unix-detailed/build-and-install/"><span>Build and install the framework</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/getting-started/installation/unix-detailed/first-simulation/"><span>Run the first simulation</span> </a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="dd-item"><i class="fa liClosed li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/running-gui/"><span>Using Graphical User Interface</span></a>
        <ul>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/running-gui/gui-overview/"><span>BornAgain GUI overview</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/running-gui/gui-fitting/"><span>Fitting in the GUI</span> </a>
    </li>
        </ul>
    </li>
    <li class="dd-item"><i class="fa liClosed li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/"><span>Working with Python scripts</span></a>
        <ul>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/setup-pycharm-project/"><span>Setup of a PyCharm project</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/basic-simulation-tutorial/"><span>Basic simulation tutorial</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/material-types/"><span>Material types</span> </a>
    </li>
    <li class="dd-item"><i class="fa liClosed li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/detector-types/"><span>Detector types</span></a>
        <ul>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/detector-types/spherical-detector/"><span>Spherical detector</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/detector-types/rectangular-detector/"><span>Rectangular detector</span> </a>
    </li>
        </ul>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/accessing-simulation-results/"><span>Accessing simulation results</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/particle-positioning/"><span>Particle positioning</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/particle-rotation/"><span>Particle rotation</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/particle-composition/"><span>Particle composition</span> </a>
    </li>
    <li class="dd-item"><i class="fa liClosed li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/interference/"><span>Interference functions</span></a>
        <ul>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/interference/lattice1d/"><span>Interference function of one-dimensional lattice</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/interference/lattice2d/"><span>Interference function of two-dimensional lattice</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/interference/para_radial/"><span>Interference function of radial paracrystal</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/interference/para2d/"><span>Interference function of 2D paracrystal</span> </a>
    </li>
        </ul>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/magnetic-particles/"><span>Magnetic particles</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/working-with-sample-parameters/"><span>Working with sample parameters</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/introduction-to-fitting/"><span>Introduction to fitting</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/basic-fitting-tutorial/"><span>Basic fitting tutorial</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/working-with-python/importing-experimental-data/"><span>Importing experimental data</span> </a>
    </li>
        </ul>
    </li>
    <li class="dd-item parent">
          <i class="fa liOpened li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/"><span>Sample model reference</span></a>
        <ul>
    <li class="dd-item"><i class="fa liClosed li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/embedded-particles/"><span>Embedded particles</span></a>
        <ul>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/embedded-particles/cylinders-ba/"><span>Cylinders in Born Approximation</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/embedded-particles/cylinders-dwba/"><span>Cylinders in Distorted Wave Born Approximation</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/embedded-particles/size-distribution/"><span>Cylinders with size distribution</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/embedded-particles/size-distribution2/"><span>Two types of cylinders with size distribution</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/embedded-particles/rotated-pyramids/"><span>Rotated Pyramids</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/embedded-particles/cylinders-and-prisms/"><span>Cylinders and Prisms</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/embedded-particles/all-formfactors/"><span>All available form factors</span> </a>
    </li>
        </ul>
    </li>
    <li class="dd-item"><i class="fa liClosed li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/layered-structures/"><span>Layered structures</span></a>
        <ul>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/layered-structures/buried-particles/"><span>Buried particles</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/layered-structures/correlated-roughness/"><span>Correlated roughness</span> </a>
    </li>
        </ul>
    </li>
    <li class="dd-item"><i class="fa liClosed li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/interference-functions/"><span>Interference functions</span></a>
        <ul>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/interference-functions/interference-1d-lattice/"><span>Interference 1D Lattice</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/interference-functions/interference-2d-square-lattice/"><span>Interference 2D Square Lattice</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/interference-functions/intereference-2d-rotated-square-lattice/"><span>Interference 2D Rotated Square Lattice</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/interference-functions/interference-2d-centered-square-lattice/"><span>Interference 2D Centered Square Lattice</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/interference-functions/spheres-at-hex-lattice/"><span>Spheres on Hexagonal Lattice</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/interference-functions/cosine-ripples-at-rect-lattice/"><span>Cosine ripples on Rectangular Lattice</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/interference-functions/interference-2d-paracrystal/"><span>Interference 2D Paracrystal</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/interference-functions/interference-1d-radial-paracrystal/"><span>Interference 1D Radial Paracrystal</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/interference-functions/approximation-da/"><span>Size-distribution model: Decoupling Approximation</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/interference-functions/approximation-lma/"><span>Size-distribution model: Local Monodisperse Approximation</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/interference-functions/approximation-ssca/"><span>Size-distribution model: Size-Spacing Coupling Approximation</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/interference-functions/rectangular-grating/"><span>Rectangular grating</span> </a>
    </li>
        </ul>
    </li>
    <li class="dd-item"><i class="fa liClosed li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/complex-shapes/"><span>Complex Shapes</span></a>
        <ul>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/complex-shapes/core-shell-nanoparticles/"><span>Core shell nanoparticles</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/complex-shapes/hexagonal-lattice-with-basis/"><span>Hexagonal Lattices with Basis</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/complex-shapes/large-particles-formfactor/"><span>Large Particle Form Factor</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/complex-shapes/custom-formfactor/"><span>Custom Form Factor</span> </a>
    </li>
        </ul>
    </li>
    <li class="dd-item"><i class="fa liClosed li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/beam-and-detector/"><span>Beam and Detector</span></a>
        <ul>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/beam-and-detector/beam-divergence/"><span>Beam divergence</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/beam-and-detector/detector-resolution/"><span>Detector Resolution Function</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/beam-and-detector/offspecular-simulation/"><span>Off-Specular</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/beam-and-detector/rectangular-detector/"><span>Rectangular Detector</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/beam-and-detector/basic-specular-simulation/"><span>Specular scattering</span> </a>
    </li>
        </ul>
    </li>
    <li class="dd-item parent">
          <i class="fa liOpened li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/fitting/"><span>Fitting</span></a>
        <ul>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/fitting/sample-parameters-intro/"><span>Working with sample parameters</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/fitting/fit-cylinders-and-prisms/"><span>Fit cylinders and prisms</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/fitting/fit-with-masks/"><span>Fitting with masks</span> </a>
    </li>
    <li class="dd-item active">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/fitting/fit-along-slices/"><span>Fitting along slices</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/fitting/simultaneous-fit-of-two-datasets/"><span>Simultaneous fit of two datasets</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/fitting/fit-galaxi-data/"><span>Real life fit example: Experiment at GALAXI</span> </a>
    </li>
        </ul>
    </li>
    <li class="dd-item"><i class="fa liClosed li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/miscellaneous/"><span>Miscellaneous</span></a>
        <ul>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/miscellaneous/accessing-simulation-results/"><span>Accessing simulation results - example</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/sample-models/miscellaneous/axes-in-different-units/"><span>Plotting with axes in different units</span> </a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="dd-item"><i class="fa liClosed li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/getting-help/"><span>Getting help</span></a>
        <ul>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/getting-help/troubleshooting/"><span>Troubleshooting</span> </a>
    </li>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/getting-help/frequently-asked-questions/"><span>Frequently asked questions</span> </a>
    </li>
        </ul>
    </li>
    <li class="dd-item"><i class="fa liClosed li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/developers-corner/"><span>Developer&#39;s corner</span></a>
        <ul>
    <li class="dd-item">
      <i class="fa liSingle li-item-icon"></i>
      <a href="https://scgmlz.github.io/BornAgain-website/documentation/developers-corner/contribute-to-documentation/"><span>Contribute to documentation</span> </a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    </ul>

    </div>
  </div>
</div>    <hr>
    
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                  <ul class="list-inline text-center">
                    
                      <li class="list-inline-item social">
                        <a href="mailto:contact@bornagainproject.org">
                          <span class="fa-stack fa-lg">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-envelope-o fa-stack-1x fa-inverse"></i>
                          </span>
                        </a>
                      </li>
                    
                    
                    <li class="list-inline-item social">
                      <a href="https://github.com/scgmlz/BornAgain">
                        <span class="fa-stack fa-lg">
                          <i class="fa fa-circle fa-stack-2x"></i>
                          <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                        </span>
                      </a>
                    </li>
                    
                  </ul>
                  <p class="copyright text-muted"></p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://scgmlz.github.io/BornAgain-website//js/bootstrap.min.js"></script>
    
    <script src="https://scgmlz.github.io/BornAgain-website//js/baguetteBox.min.js"></script>
    <script>
      baguetteBox.run('.galleryscg');
    </script>    
    
    <script src="https://scgmlz.github.io/BornAgain-website//js/theme.js"></script>
    <script src="https://scgmlz.github.io/BornAgain-website/assets/js/bornagain.js"></script>
    
    
</body>
</html>


